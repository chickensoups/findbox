<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Findbox</title>
    <link rel="stylesheet" type="text/css" href="common.css">
    <style>
        .item {
            width: 100px;
            height: 100px;
            border: 1px solid gray;
            border-radius: 10%;
        }

        .switch {
            color: white;
            font-weight: bold;
            border-radius: 5%;
            border: 1px white solid;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="row">
        <label id="level-name">Cửa số 7</label>
    </div>
    <div class="row">
        <label id="requirements">Tìm 3 hộp!</label>
    </div>
    <div class="row">
        <label id="message"></label>
    </div>
    <div class="row  main-content">
        <div id="item-picker-1" class="row item-picker">
            <img id="item-1" class="item" src="resources/fruit-2.png">
            <button id="switch-1" class="switch" onclick="runItemPicker1()" type="button">Start</button>
        </div>
        <div id="item-picker-2" class="row item-picker">
            <img id="item-2" class="item" src="resources/fruit-4.png">
            <button id="switch-2" class="switch" onclick="runItemPicker2()" type="button">Start</button>
        </div>
        <div id="item-picker-3" class="row item-picker">
            <img id="item-3" class="item" src="resources/fruit-6.png">
            <button id="switch-3" class="switch" onclick="runItemPicker3()" type="button">Start</button>
        </div>
    </div>
    <div class="row">
        <button id="next-level-btn" type="button" onclick="nextLevel('level_07')">>> Cửa tiếp</button>
    </div>
</div>
<script src="common.js"></script>
<script>
  let item1 = document.getElementById('item-1');
  let switch1 = document.getElementById('switch-1');
  switch1.style.backgroundColor = 'green';
  let interval1;

  let item2 = document.getElementById('item-2');
  let switch2 = document.getElementById('switch-2');
  switch2.style.backgroundColor = 'green';
  let interval2;

  let item3 = document.getElementById('item-3');
  let switch3 = document.getElementById('switch-3');
  switch3.style.backgroundColor = 'green';
  let interval3;

  function runItemPicker1() {
    const images = ['resources/fruit-0.png', 'resources/fruit-1.png', 'resources/fruit-2.png', 'resources/fruit-3.png',
      'resources/fruit-4.png', 'resources/fruit-5.png', 'resources/fruit-6.png', 'resources/fruit-7.png',]
    let imgIndex = 1;
    if (switch1.innerText === 'Start') {
      // Start the picker
      switch1.innerText = 'Stop';
      switch1.style.backgroundColor = 'red';
      interval1 = setInterval(() => {
        imgIndex = imgIndex % images.length;
        item1.setAttribute('src', images[imgIndex++])
      }, 1000)
    } else {
      // Stop the picker
      clearInterval(interval1);
      switch1.innerText = 'Start';
      switch1.style.backgroundColor = 'green';
      checkResult();
    }
  }

  function runItemPicker2() {
    const images = ['resources/fruit-0.png', 'resources/fruit-1.png', 'resources/fruit-2.png', 'resources/fruit-3.png',
      'resources/fruit-4.png', 'resources/fruit-5.png', 'resources/fruit-6.png', 'resources/fruit-7.png',]
    let imgIndex = 4;
    if (switch2.innerText === 'Start') {
      // Start the picker
      switch2.innerText = 'Stop';
      switch2.style.backgroundColor = 'red';
      interval2 = setInterval(() => {
        imgIndex = imgIndex % images.length;
        item2.setAttribute('src', images[imgIndex++])
      }, 100)
    } else {
      // Stop the picker
      clearInterval(interval2);
      switch2.innerText = 'Start';
      switch2.style.backgroundColor = 'green';
      checkResult();
    }
  }

  function runItemPicker3() {
    const images = ['resources/fruit-0.png', 'resources/fruit-1.png', 'resources/fruit-2.png', 'resources/fruit-3.png',
      'resources/fruit-4.png', 'resources/fruit-5.png', 'resources/fruit-6.png', 'resources/fruit-7.png','resources/fruit-1.png', 'resources/fruit-0.png', 'resources/fruit-2.png', 'resources/fruit-3.png',
      'resources/fruit-4.png', 'resources/fruit-5.png', 'resources/fruit-6.png', 'resources/fruit-7.png']
    let imgIndex = 6;
    if (switch3.innerText === 'Start') {
      // Start the picker
      switch3.innerText = 'Stop';
      switch3.style.backgroundColor = 'red';
      interval3 = setInterval(() => {
        imgIndex = imgIndex % images.length;
        item3.setAttribute('src', images[imgIndex++])
      }, 10)
    } else {
      // Stop the picker
      clearInterval(interval3);
      switch3.innerText = 'Start';
      switch3.style.backgroundColor = 'green';
      checkResult();
    }
  }

  function checkResult() {
    const finboxImg = 'resources/fruit-0.png';
    if (item1.getAttribute('src') === finboxImg && item2.getAttribute('src') === finboxImg && item3.getAttribute('src') === finboxImg) {
      updateMessage('Bạn thật là may mắn! Hãy đến với của cuối cùng số 8', MSG_SUCCESS);
      showTheNextLevelButton();
    }
  }
</script>
</body>
</html>
